@page
@model EVCenterService.Pages.Customer.Invoices.IndexModel
@{
    ViewData["Title"] = "Hóa Đơn Của Tôi";
    Layout = "_CustomerLayout";
}

<div class="page-header">
    <h1 class="mb-0">@ViewData["Title"]</h1>
</div>

<div class="card data-card mt-4">
    @if (Model.InvoiceList == null || !Model.InvoiceList.Any())
    {
        <div class="card-body">
            <div class="alert alert-info text-center mb-0">Bạn chưa có hóa đơn nào.</div>
        </div>
    }
    else
    {
        <div class="appointment-card-list p-3">
            @foreach (var invoice in Model.InvoiceList)
            {
                var badgeClass = invoice.Status == "Paid" ? "badge-custom bg-success" : "badge-custom bg-danger";
                var statusText = invoice.Status == "Paid" ? "ĐÃ THANH TOÁN" : "CHƯA THANH TOÁN";

                // Lấy tên Xe (hoặc tên Gói)
                var itemName = invoice.Order?.Vehicle?.Model ?? invoice.Subscription?.Plan?.Name ?? "N/A";

                <div class="invoice-card-item">

                    <div class="icon-wrapper">
                        <i class="bi bi-receipt"></i>
                    </div>

                    <div class="info-block">
                        <span class="label">Mã HĐ</span>
                        <h5 class="value" style="font-size: 1rem; margin-bottom: 0;">#HD-@invoice.InvoiceId</h5>
                    </div>

                    <div class="info-block">
                        <span class="label">Xe / Gói Dịch Vụ</span>
                        <span class="value fw-bold">@itemName</span>
                    </div>

                    <div class="info-block">
                        <span class="label">Ngày tạo</span>
                        <span class="value">@invoice.IssueDate?.ToString("dd/MM/yyyy")</span>
                    </div>

                    <div class="info-block">
                        <span class="label">Tổng tiền</span>
                        <span class="value fw-bold">@invoice.Amount?.ToString("N0") đ</span>
                    </div>

                    <div class="info-block">
                        <span class="label">Trạng thái</span>
                        <span class="badge @badgeClass" style="font-size: 0.75rem;">@statusText</span>
                    </div>

                    <div class="action-buttons">
                        <a asp-page="./Details" asp-route-id="@invoice.InvoiceId" class="btn btn-sm btn-primary">
                            <i class="bi bi-eye-fill me-1"></i> Xem
                        </a>
                    </div>
                </div>
            }
        </div>
    }
    </div>
</div>