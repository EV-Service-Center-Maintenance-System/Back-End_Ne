@page "{id:int}"
@model EVCenterService.Pages.Technician.Jobs.DetailsModel
@{
    Layout = "_AppLayout";
    ViewData["Title"] = "Job Details";
}

<h2 class="mb-4">Job Details #@Model.Job.OrderId</h2>

<div class="card shadow-sm">
    <div class="card-body">
        <p><strong>Khách hàng:</strong> @Model.Job.User?.FullName (@Model.Job.User?.Email)</p>
        <p><strong>Xe:</strong> @Model.Job.Vehicle?.Model</p>
        <p><strong>Dịch vụ:</strong> @string.Join(", ", Model.Job.OrderDetails.Select(d => d.Service?.Name))</p>
        <p><strong>Ngày hẹn:</strong> @Model.Job.AppointmentDate.ToString("dd/MM/yyyy HH:mm")</p>
        <p><strong>Ghi chú từ khách hàng:</strong> @Model.Job.ChecklistNote</p>

        <div class="mt-3 mb-3">
            <a asp-page="ManageParts"
               asp-route-orderId="@Model.Job.OrderId"
               asp-route-centerId="@Model.Job.Slot?.CenterId"
               class="btn btn-outline-primary">
                ⚙️ Quản lý vật tư
            </a>
        </div>

        <form method="post">
            <div class="mb-3">
                <label class="form-label">Ghi chú của kỹ thuật viên</label>
                <textarea class="form-control" rows="3" name="TechnicianNote"></textarea>
            </div>
            <button type="submit" asp-page-handler="Complete" asp-route-id="@Model.Job.OrderId" class="btn btn-success me-2">
                ✅ Đánh Dấu Hoàn Thành
            </button>
            <button type="submit" asp-page-handler="Cancel" asp-route-id="@Model.Job.OrderId" class="btn btn-danger">
                ❌ Hủy Công Việc
            </button>
        </form>
    </div>
</div>
